function protectIP(input, event) {
    const value = input.value;
    const cursorPos = input.selectionStart;
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–∑–∏—Ü–∏–∏ —Ç–æ—á–µ–∫
    const firstDotPos = value.indexOf('.');
    const secondDotPos = value.indexOf('.', firstDotPos + 1);
    const thirdDotPos = value.indexOf('.', secondDotPos + 1);
    
    // üî• –û–ë–†–ê–ë–û–¢–ö–ê –í–í–û–î–ê –¶–ò–§–† –° –ê–í–¢–û–ü–ï–†–ï–ù–û–°–û–ú (–î–û–ë–ê–í–õ–ï–ù–û –¢–û–õ–¨–ö–û –≠–¢–û)
    if (event.key.length === 1 && /\d/.test(event.key)) {
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–∏–π –æ–∫—Ç–µ—Ç
        const octetPositions = getOctetPositions(value);
        const currentOctet = getCurrentOctet(cursorPos, octetPositions);
        
        // üî• –ê–í–¢–û–ü–ï–†–ï–ù–û–° –ü–†–ò –í–í–û–î–ï 3-–ô –¶–ò–§–†–´ –í –¢–†–ï–¢–¨–ï–ú –û–ö–¢–ï–¢–ï
        if (currentOctet === 2 && thirdDotPos !== -1) {
            const thirdOctet = value.substring(secondDotPos + 1, thirdDotPos);
            
            // –ï—Å–ª–∏ –≤–≤–æ–¥–∏–º 3-—é —Ü–∏—Ñ—Ä—É –≤ —Ç—Ä–µ—Ç—å–µ–º –æ–∫—Ç–µ—Ç–µ –∏ –∫—É—Ä—Å–æ—Ä –≤ –∫–æ–Ω—Ü–µ –æ–∫—Ç–µ—Ç–∞
            if (thirdOctet.length === 2 && cursorPos === secondDotPos + 1 + 2) {
                event.preventDefault();
                
                // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å –¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–π —Ü–∏—Ñ—Ä–æ–π
                const newThirdOctet = thirdOctet + event.key;
                const newValue = value.substring(0, secondDotPos + 1) + newThirdOctet + value.substring(thirdDotPos);
                
                input.value = newValue;
                
                // üî• –ü–ï–†–ï–ù–û–°–ò–ú –ö–£–†–°–û–† –í 4-–ô –û–ö–¢–ï–¢ (–ø–æ—Å–ª–µ 3-–π —Ç–æ—á–∫–∏)
                input.setSelectionRange(thirdDotPos + 1, thirdDotPos + 1);
                return;
            }
        }
        
        // üî• –ü–†–û–í–ï–†–ö–ê –õ–ò–ú–ò–¢–û–í (–°–û–•–†–ê–ù–ï–ù–ê –°–¢–ê–†–ê–Ø –õ–û–ì–ò–ö–ê)
        if (currentOctet === 2) {
            const currentOctetText = getCurrentOctetText(value, currentOctet);
            if (currentOctetText.length >= 3 && cursorPos <= thirdDotPos) {
                event.preventDefault();
                return;
            }
        }
        
        if (currentOctet === 3) {
            const currentOctetText = getCurrentOctetText(value, currentOctet);
            if (currentOctetText.length >= 3) {
                event.preventDefault();
                return;
            }
        }
    }
    
    // üî• –í–°–Ø –û–°–¢–ê–õ–¨–ù–ê–Ø –õ–û–ì–ò–ö–ê –û–°–¢–ê–ï–¢–°–Ø –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô
    // Backspace, Delete, —Å—Ç—Ä–µ–ª–∫–∏ –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–µ-—Ü–∏—Ñ—Ä
    
    // üî• –û–ë–†–ê–ë–û–¢–ö–ê BACKSPACE (–ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô)
    if (event.key === 'Backspace') {
        // –ë–ª–æ–∫–∏—Ä—É–µ–º —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫ (–º–µ–∂–¥—É 10.160)
        if (cursorPos === firstDotPos + 1 || cursorPos === secondDotPos + 1) {
            event.preventDefault();
            return;
        }
        
        // üî• –£–î–ê–õ–ï–ù–ò–ï –ü–û–°–õ–ï–î–ù–ï–ô –¶–ò–§–†–´ 4-–ì–û –û–ö–¢–ï–¢–ê - –ü–ï–†–ï–ù–û–° –í 3-–ô –û–ö–¢–ï–¢
        if (cursorPos === value.length && thirdDotPos !== -1) {
            const fourthOctet = value.substring(thirdDotPos + 1);
            if (fourthOctet.length === 1) {
                // "10.160.111.1|" ‚Üí Backspace ‚Üí "10.160.111|."
                event.preventDefault();
                const newValue = value.substring(0, value.length - 1);
                input.value = newValue;
                input.setSelectionRange(thirdDotPos, thirdDotPos);
                return;
            }
        }
        
        // üî• –£–î–ê–õ–ï–ù–ò–ï –í –¢–†–ï–¢–¨–ï–ú –û–ö–¢–ï–¢–ï –° –°–û–•–†–ê–ù–ï–ù–ò–ï–ú –¢–û–ß–ö–ò
        if (cursorPos === thirdDotPos) {
            // "10.160.111.|" ‚Üí Backspace ‚Üí "10.160.11|."
            event.preventDefault();
            const thirdOctet = value.substring(secondDotPos + 1, thirdDotPos);
            if (thirdOctet.length > 0) {
                const newThirdOctet = thirdOctet.slice(0, -1);
                const newValue = value.substring(0, secondDotPos + 1) + newThirdOctet + value.substring(thirdDotPos);
                input.value = newValue;
                const newCursorPos = secondDotPos + 1 + newThirdOctet.length;
                input.setSelectionRange(newCursorPos, newCursorPos);
            }
            return;
        }
        
        // üî• –£–î–ê–õ–ï–ù–ò–ï –¶–ò–§–† –ü–ï–†–ï–î –¢–û–ß–ö–û–ô –í –¢–†–ï–¢–¨–ï–ú –û–ö–¢–ï–¢–ï
        if (cursorPos > secondDotPos + 1 && cursorPos < thirdDotPos) {
            const thirdOctet = value.substring(secondDotPos + 1, thirdDotPos);
            const digitIndex = cursorPos - (secondDotPos + 1);
            
            if (digitIndex === thirdOctet.length && thirdOctet.length > 0) {
                // "10.160.11|." ‚Üí Backspace ‚Üí "10.160.1|."
                event.preventDefault();
                const newThirdOctet = thirdOctet.slice(0, -1);
                const newValue = value.substring(0, secondDotPos + 1) + newThirdOctet + value.substring(thirdDotPos);
                input.value = newValue;
                const newCursorPos = secondDotPos + 1 + newThirdOctet.length;
                input.setSelectionRange(newCursorPos, newCursorPos);
                return;
            }
        }
        
        // üî• –£–î–ê–õ–ï–ù–ò–ï –ü–û–°–õ–ï–î–ù–ï–ô –¶–ò–§–†–´ –¢–†–ï–¢–¨–ï–ì–û –û–ö–¢–ï–¢–ê (–ü–ï–†–ï–î –¢–û–ß–ö–û–ô)
        if (cursorPos === thirdDotPos && thirdDotPos !== -1) {
            const thirdOctet = value.substring(secondDotPos + 1, thirdDotPos);
            if (thirdOctet.length > 0) {
                // "10.160.1|." ‚Üí Backspace ‚Üí "10.160.|" (—Ç–æ—á–∫–∞ –ù–ï —É–¥–∞–ª—è–µ—Ç—Å—è)
                event.preventDefault();
                const newThirdOctet = thirdOctet.slice(0, -1);
                const newValue = value.substring(0, secondDotPos + 1) + newThirdOctet + value.substring(thirdDotPos);
                input.value = newValue;
                const newCursorPos = secondDotPos + 1 + newThirdOctet.length;
                input.setSelectionRange(newCursorPos, newCursorPos);
                return;
            }
        }
        
        // üî• –ë–õ–û–ö–ò–†–û–í–ö–ê –£–î–ê–õ–ï–ù–ò–Ø –ü–ï–†–ï–î –ó–ê–©–ò–©–ï–ù–ù–´–ú–ò –¢–û–ß–ö–ê–ú–ò
        if (cursorPos === firstDotPos || cursorPos === secondDotPos) {
            event.preventDefault();
            return;
        }
    }
    
    // üî• –û–ë–†–ê–ë–û–¢–ö–ê DELETE (–ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô)
    if (event.key === 'Delete') {
        if (cursorPos === firstDotPos || cursorPos === secondDotPos) {
            event.preventDefault();
            return;
        }
    }
    
    // üî• –û–ë–†–ê–ë–û–¢–ö–ê –°–¢–†–ï–õ–û–ö (–ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô)
    if (event.key === 'ArrowLeft' || event.key === 'ArrowRight') {
        return;
    }
    
    // üî• –ë–õ–û–ö–ò–†–û–í–ö–ê –ù–ï-–¶–ò–§–† (–ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô)
    if (event.key.length === 1 && !/\d/.test(event.key)) {
        event.preventDefault();
        return;
    }
}